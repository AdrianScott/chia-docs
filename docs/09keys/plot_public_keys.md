---
sidebar_position: 3
---

# 9.3 Plot Public Keys

So, what is the plot public key shown in the previous section? The plot public key is a 2/2 BLS aggregate public key, which
is generated by combining the farmer public key with the local public key.
The local public key is a totally random key that is created for each plot, and put into the plot. They are not children
of any BLS keys, and therefore totally independent between plots.
The farmer key is a key that the farmer machine stores.

For plots which are generated for use with the Plot NFT pooling protocol, an additional "taproot" secret key is used,
making the aggregate key a 3/3. This 3rd key can be derived from public information of the other 2 keys, and it ensures
that an attacker cannot create two new keys k1 and k2 such that they both add up to the original aggregate key.
The taproot private key is defined as: 

```python
BLSKeyGen(sha256(bytes(local_pk + farmer_pk) + bytes(local_pk) + bytes(farmer_pk)))
```

Each block requires a signature from the plot key. What this means, is that we need to combine two signatures: one from the local secret key, which is generated by the harvester, and one from the
farmer sk, which is generated by the farmer. The farmer combines both signatures to generate the plot signature.


## Plot format

The plot format depends on whether farm to public key or farm to contract address is being used. If farming to a contract
address, the puzzle hash (address) is directly encoded into the plot. Otherwise, the pool public key is directly encoded into the plot.
Note that this is not the exact plot format, there are a few more details that are left out here.


The important thing is that the harvester is only storing their local key in the plot, but no other keys are required
from the harvester. This key alone is not enough to do anything, since it must be combined with the farmer's key. 
Therefore compromising the harvester does not allow an attack to redirect rewards.
